!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):n.urlComposer=r()}(this,function(){"use strict";function n(n){return"[object Array]"===Object.prototype.toString.call(n)}function r(n){if(null==n)return!0;if(n.length>0)return!1;if(0===n.length)return!0;if("object"!=typeof n)return!0;for(var r in n)if(hasOwnProperty.call(n,r))return!1;return!0}function e(n,e){return n=n||"",e=e||[],r(e)?o(n):(n=t(n,e),i(f(n)))}function t(r,e){if(e=e||[],!n(e)){var t=r.match(R);e=t.map(function(n){return e[n.substr(1)]})}e.forEach(function(n){r=a(r,n)});var o=r.match(w);return o&&o.forEach(function(n){u(n)&&(r=r.replace(n,""))}),r}function a(n,r){var e=n.indexOf(":")!==-1;return r=encodeURIComponent(r),e?n.replace(P,r):n.replace(E,r)}function u(n){return P.test(n)||E.test(n)}function o(n){return n.replace(w,"")}function i(n){return n.replace(x,"")}function c(n){return n.replace(j,"")}function f(n){return n.replace(O,"")}function p(n){var r=n.host,e=n.path,t=n.query,a=n.hash;return r=i(r),e=i(c(e)),e=e?"/"+e:"",t=t?"?"+t:"",a=a?"#"+a:"",""+r+e+t+a}function s(n,r){for(var e=[],t=0;t<n.length;t++){var a=n[t];a[r]&&""===a.value&&e.push(a)}return e}function l(n){return{named:n.match(R)||[],splat:n.match(E)||[]}}function h(n){return n=n.replace($,"\\$&").replace(w,"(?:$1)?").replace(R,function(n,r){return r?n:"([^/?]+)"}).replace(E,"([^?]*?)"),new RegExp("^"+n+"(?:\\?([\\s\\S]*))?$")}function m(n){return n=n||{},e(n.path,n.params)}function d(n){var r=[];n=n||{};for(var e in n.query){var t=n.query[e];r.push(e+"="+encodeURIComponent(t))}return r.length?r.join("&"):""}function v(n){n=n||{};var r=h(n.path);return r.test(n.url)}function g(n){n=n||{},n.host=n.host||"";var r=m(n),e=d(n);return p({host:n.host,path:r,query:e,hash:n.hash})}function y(n,r){function e(n){t[n.slice(1)]=r[u++]}var t={},a=l(n),u=0;return a.named.forEach(e),a.splat.forEach(e),t}function q(r,e){var t=r.match(w)||[],a=l(r),u=a.named,o=a.splat,i=u.concat(o);return e=e||{},n(e)&&(e=y(r,e)),i=i.map(function(n){for(var r=!1,a=0;a<t.length;a++){var u=t[a];if(u.indexOf(n)!==-1){r=!0;break}}return{name:n,value:e[n.slice(1)]||"",optional:r,required:!r}}),{params:i,hasOptionalParams:w.test(r),missingOptionalParams:s(i,"optional"),missingRequiredParams:s(i,"required"),missingParams:s(i,"name")}}function b(n){void 0===n&&(n={});var r=n.path,e=n.definition,t=n.object,a=h(e),u=a.exec(r).slice(1),o=u.map(function(n,r){return r===u.length-1?n||null:n?decodeURIComponent(n):null});if(t){var i=o.pop();o=y(e,o),o.query=i}return o}var x=/\/$/,j=/^\//,O=/[\(\)]/g,w=/\((.*?)\)/g,E=/\*\w+/g,P=/(\(\?)?:\w+/,R=/(\(\?)?:\w+/g,$=/[\-{}\[\]+?.,\\\^$|#\s]/g,C={build:g,test:v,stats:q,parse:b,params:y,path:m,query:d,regex:h,match:l};return C});