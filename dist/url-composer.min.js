!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):r.urlComposer=n()}(this,function(){"use strict";function r(r){return"[object Array]"===Object.prototype.toString.call(r)}function n(r){if(null==r)return!0;if(r.length>0)return!1;if(0===r.length)return!0;if("object"!=typeof r)return!0;for(var n in r)if(hasOwnProperty.call(r,n))return!1;return!0}function t(r,t){return r=r||"",t=t||[],n(t)?o(r):(r=e(r,t),i(f(r)))}function e(n,t){if(t=t||[],!r(t)){var e=n.match(P);t=e.map(function(r){return t[r.substr(1)]})}t.forEach(function(r){n=a(n,r)});var o=n.match(j);return o&&o.forEach(function(r){u(r)&&(n=n.replace(r,""))}),n}function a(r,n){var t=r.indexOf(":")!==-1;return n=encodeURIComponent(n),t?r.replace(E,n):r.replace(w,n)}function u(r){return E.test(r)||w.test(r)}function o(r){return r.replace(j,"")}function i(r){return r.replace(b,"")}function c(r){return r.replace(x,"")}function f(r){return r.replace(O,"")}function s(r){var n=r.host,t=r.path,e=r.query,a=r.hash;return n=i(n),t=i(c(t)),t=t?"/"+t:"",e=e?"?"+e:"",a=a?"#"+a:"",""+n+t+e+a}function p(r,n){for(var t=[],e=0;e<r.length;e++){var a=r[e];a[n]&&""===a.value&&t.push(a)}return t}function l(r){return{named:r.match(P)||[],splat:r.match(w)||[]}}function h(r){return r=r.replace($,"\\$&").replace(j,"(?:$1)?").replace(P,function(r,n){return n?r:"([^/?]+)"}).replace(w,"([^?]*?)"),new RegExp("^"+r+"(?:\\?([\\s\\S]*))?$")}function m(r){return r=r||{},t(r.path,r.params)}function d(r){var n=[];r=r||{};for(var t in r.query){var e=r.query[t];n.push(t+"="+encodeURIComponent(e))}return n.length?n.join("&"):""}function v(r){r=r||{};var n=h(r.path);return n.test(r.url)}function g(r){r=r||{},r.host=r.host||"";var n=m(r),t=d(r);return s({host:r.host,path:n,query:t,hash:r.hash})}function y(r,n){function t(r){e[r.slice(1)]=n[u++]}var e={},a=l(r),u=0;return a.named.forEach(t),a.splat.forEach(t),e}function q(r,n){var t=r.match(j),e=l(r),a=e.named,u=e.splat,o=a.concat(u);return n=n||{},o=o.map(function(r){for(var e=!1,a=0;a<t.length;a++){var u=t[a];if(u.indexOf(r)!==-1){e=!0;break}}return{name:r,value:n[r.slice(1)]||"",optional:e,required:!e}}),{params:o,hasOptionalParams:j.test(r),missingOptionalParams:p(o,"optional"),missingRequiredParams:p(o,"required"),missingParams:p(o,"name")}}var b=/\/$/,x=/^\//,O=/[\(\)]/g,j=/\((.*?)\)/g,w=/\*\w+/g,E=/(\(\?)?:\w+/,P=/(\(\?)?:\w+/g,$=/[\-{}\[\]+?.,\\\^$|#\s]/g,R={build:g,test:v,params:y,stats:q,path:m,query:d,regex:h,match:l};return R});